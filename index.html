<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat WhatsApp - Simulado</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Inter, system-ui, Arial, sans-serif}
  body{background:#121b22;display:flex;align-items:center;justify-content:center;height:100vh}
  .app{width:100%;max-width:420px;height:600px;background:#1e2c33;border-radius:16px;display:flex;flex-direction:column;overflow:hidden}
  .header{height:72px;padding:12px 14px;display:flex;align-items:center;border-bottom:1px solid #2a3a40;flex-shrink:0;background:#1e2c33;position:sticky;top:0;z-index:10}
  .avatar{width:48px;height:48px;border-radius:50%;overflow:hidden;margin-right:12px;flex-shrink:0;background:#ccc}
  .avatar img{width:100%;height:100%;object-fit:cover}
  .meta{flex:1;color:#fff}
  .name{font-weight:600}
  .status{font-size:12px;color:#b0b0b0}
  .messages{flex:1;padding:20px;display:flex;flex-direction:column;gap:12px;overflow-y:auto;background:#121b22}
  .bubble{max-width:78%;padding:10px 14px;border-radius:18px;line-height:1.35;position:relative;color:#fff}
  .from-bot{background:#2a3a40;border-top-left-radius:6px;align-self:flex-start}
  .from-me{background:#056162;border-top-right-radius:6px;align-self:flex-end}
  .composer{border-top:1px solid #2a3a40;padding:10px;display:flex;flex-direction:column;gap:6px;background:#1e2c33;flex-shrink:0}
  .row{display:flex;align-items:center;gap:8px}
  .input{flex:1;background:#24333b;border-radius:20px;padding:10px 14px;min-height:44px;color:#fff;display:flex;align-items:center}
  .input[contenteditable]{outline:none}
  .btn{background:#25d366;border-radius:12px;padding:8px 12px;color:white;font-weight:600;border:none;cursor:pointer}
  .suggestions-container{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
  .suggestion-btn{background:#25d366;color:white;padding:6px 12px;border-radius:18px;border:none;cursor:pointer;font-weight:600;font-size:14px}
  .checkout-link{display:block;margin-top:6px;color:#00afff;text-decoration:underline;cursor:pointer;font-weight:600}

  /* áudio estilo WhatsApp */
  .audio {
    position: relative;
    width: 60px;
    height: 40px;
    background: #25d366;
    border-radius: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }
  .audio .triangle {
    width: 0;
    height: 0;
    border-left: 12px solid white;
    border-top: 8px solid transparent;
    border-bottom: 8px solid transparent;
    margin-left: 2px;
  }
  .audio .waves {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 40px;
    height: 40px;
    transform: translate(-50%, -50%);
    display: flex;
    gap: 2px;
    opacity: 0;
  }
  .audio .wave {
    width: 4px;
    background: rgba(255,255,255,0.8);
    border-radius: 2px;
    animation: waveAnim 0.6s infinite;
  }
  .audio.playing .waves {opacity: 1;}
  .audio .wave:nth-child(1) { animation-delay: 0s; }
  .audio .wave:nth-child(2) { animation-delay: 0.2s; }
  .audio .wave:nth-child(3) { animation-delay: 0.4s; }
  @keyframes waveAnim {0%,100%{height:8px;}50%{height:20px;}}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="avatar">
      <img src="https://somosnews.com.mx/wp-content/uploads/2024/02/modelos-triunfan-redes-sociales-inteligencia-artificial.jpg" alt="Melissa">
    </div>
    <div class="meta">
      <div class="name">Melissa Castro</div>
      <div class="status" id="status">online</div>
    </div>
  </div>

  <div class="messages" id="messages"></div>

  <div class="composer">
    <div id="suggestionsArea" class="suggestions-container"></div>
    <div class="row">
      <div class="input" id="input" contenteditable="true" role="textbox" aria-multiline="true" placeholder="Escreva uma mensagem..."></div>
      <button class="btn" id="sendBtn">Enviar</button>
    </div>
  </div>
</div>

<script>
const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');
const suggestionsArea = document.getElementById('suggestionsArea');

let userResponded = false;
let firstAutoResponseDone = false;
let courseOptionsSent = false;

// criar bubble
function appendBubble(text, who='bot', extras={}){
  const b = document.createElement('div');
  b.className = 'bubble ' + (who==='bot' ? 'from-bot' : 'from-me');

  if(extras.isAudio){
    const audioWrap = document.createElement('div');
    audioWrap.className='audio';

    const triangle = document.createElement('div');
    triangle.className='triangle';
    audioWrap.appendChild(triangle);

    const waves = document.createElement('div');
    waves.className='waves';
    for(let i=0;i<3;i++){
      const w = document.createElement('div');
      w.className='wave';
      waves.appendChild(w);
    }
    audioWrap.appendChild(waves);

    const audioEl = new Audio(extras.src);
    audioWrap.addEventListener('click', ()=>{
      audioEl.play();
      audioWrap.classList.add('playing');
      audioEl.onended = ()=>audioWrap.classList.remove('playing');
      appendSuggestions(['Não, quero comprar o curso']);
    });

    b.appendChild(audioWrap);

  } else if(extras.isCheckout){
    b.innerHTML = `${text}<a class="checkout-link" href="${extras.link}" target="_blank">Clique aqui para comprar</a>`;
    appendSuggestions(['Escolher outras opções']);
  } else {
    b.innerHTML = text.replace(/\n/g,'<br>');
  }

  messagesEl.appendChild(b);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

// criar sugestões
function appendSuggestions(options){
  suggestionsArea.innerHTML='';
  options.forEach(opt=>{
    const btn = document.createElement('button');
    btn.className='suggestion-btn';
    btn.innerText=opt;
    btn.addEventListener('click', ()=>{
      appendBubble(opt,'me');
      handleResponse(opt);
      suggestionsArea.innerHTML='';
    });
    suggestionsArea.appendChild(btn);
  });
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

// lidar com respostas
function handleResponse(text){
  const lowerText = text.toLowerCase();

  if(lowerText==='escolher outras opções'){
    setTimeout(()=>appendBubble('Ah perfeito meu amor, qual você gostaria então. O Hot Starter, Hot Essential ou Hot Founder?','bot'),500);
    setTimeout(()=>appendSuggestions(['Hot Starter','Hot Essential','Hot Founder']),800);
    return;
  }

  if(['hot starter','hot essential','hot founder'].includes(lowerText)){
    let link='';
    if(lowerText==='hot starter') link='https://go.perfectpay.com.br/PPU38CQ08HP';
    else if(lowerText==='hot essential') link='https://go.perfectpay.com.br/PPU38CQ08I2';
    else if(lowerText==='hot founder') link='https://go.perfectpay.com.br/PPU38CQ08I3';

    setTimeout(()=>{
      appendBubble('Ótima escolha, vou te enviar o link checkout para você iniciar suas operações agora mesmo!','bot',{isCheckout:true, link:link});
    },500);
    return;
  }

  if(!firstAutoResponseDone){
    firstAutoResponseDone = true;
    setTimeout(()=>{
      appendBubble('Ótimo, vou te enviar alguns detalhes sobre o curso','bot');
      setTimeout(()=>{
        appendBubble(
          'Temos 3 modelos de curso, sendo o Hot Starter, onde você vai aprender o básico como criar sua própria modelo do job; o Hot Essential, onde você aprenderá do básico ao avançado e receberá todos os links e dicas valiosas; e, por fim, para uma estrutura sólida e escalável, temos o Hot Founder, onde você aprenderá tudo inclusive criar sua modelo com IA. Qual dos 3 você tem interesse?',
          'bot'
        );
        setTimeout(()=>appendSuggestions(['Hot Starter','Hot Essential','Hot Founder']),500);
        courseOptionsSent = true;
      },500);
    },500);
  }
}

// enviar mensagem do usuário
function sendMessage(){
  const text = inputEl.innerText.trim();
  if(!text) return;
  appendBubble(text,'me');
  inputEl.innerText = '';

  if(!userResponded){
    userResponded = true;
    setTimeout(()=>{ 
      appendBubble(null,'bot',{isAudio:true, src:'https://s31.aconvert.com/convert/p3r68-cdx67/8kair-dvode.mp3'});
    }, 800);
  } else {
    handleResponse(text);
  }
}

// eventos
sendBtn.addEventListener('click', sendMessage);
inputEl.addEventListener('keydown', e=>{
  if(e.key==='Enter' && !e.shiftKey){e.preventDefault(); sendMessage();}
});

// mensagem inicial
window.addEventListener('load', ()=>{
  appendBubble('Oiie meu amor, tudo bem? eu me chamo Melissa.','bot');
});
</script>
</body>
</html>
