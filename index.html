<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Chat WhatsApp - Robotizado</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Inter, system-ui, Arial, sans-serif}
body{background:#ece5dd;display:flex;align-items:center;justify-content:center;height:100vh}
.app{width:420px;height:780px;background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.12);display:flex;flex-direction:column;overflow:hidden}
.header{height:72px;padding:12px 14px;display:flex;align-items:center;border-bottom:1px solid #ddd;background:#ededed}
.avatar{width:48px;height:48px;border-radius:50%;overflow:hidden;margin-right:12px;flex-shrink:0;background:#ccc}
.avatar img{width:100%;height:100%;object-fit:cover}
.meta{flex:1}
.name{font-weight:600;font-size:16px;color:#222}
.status{font-size:12px;color:#666}
.messages{flex:1;padding:12px;display:flex;flex-direction:column;gap:8px;overflow-y:auto;background:#e5ddd5}
.bubble{max-width:75%;padding:8px 12px;border-radius:18px;line-height:1.4;word-wrap:break-word;position:relative}
.from-bot{background:#fff;align-self:flex-start;border-top-left-radius:4px;border-top-right-radius:18px;border-bottom-left-radius:18px;border-bottom-right-radius:18px;box-shadow:0 1px 1px rgba(0,0,0,0.1)}
.from-me{background:#dcf8c6;align-self:flex-end;border-top-left-radius:18px;border-top-right-radius:4px;border-bottom-left-radius:18px;border-bottom-right-radius:18px;box-shadow:0 1px 1px rgba(0,0,0,0.1)}
.composer{height:70px;border-top:1px solid #ddd;padding:8px 12px;display:flex;align-items:center;gap:8px;background:#f0f0f0}
.input{flex:1;background:#fff;border-radius:20px;padding:10px 14px;min-height:44px;display:flex;align-items:center}
.input[contenteditable]{outline:none}
.btn{background:#25d366;border-radius:50%;padding:0 16px;color:white;font-weight:bold;border:none;height:44px;width:44px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px}
.audio{display:flex;align-items:center;gap:8px}
.play{width:36px;height:36px;border-radius:50%;display:grid;place-items:center;border:1px solid #ddd;cursor:pointer;background:#25d366;color:#fff;font-weight:bold}
.typing{font-size:12px;color:#666;margin-left:6px}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="avatar">
      <img src="https://osegredo.com.br/wp-content/uploads/2024/01/Emily-Pellegrini-1.jpg" alt="Melissa Castro">
    </div>
    <div class="meta">
      <div class="name">Melissa Castro</div>
      <div class="status" id="status">online</div>
    </div>
  </div>

  <div class="messages" id="messages"></div>

  <div class="composer">
    <div class="input" id="input" contenteditable="true" role="textbox" aria-multiline="true" placeholder="Escreva uma mensagem..."></div>
    <button class="btn" id="sendBtn">▶</button>
  </div>
</div>

<script>
const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');

function appendBubble(text='', who='bot', extras={}){
  const b = document.createElement('div');
  b.className = 'bubble ' + (who==='bot' ? 'from-bot' : 'from-me');

  if(extras.isAudio){
    const audioWrap = document.createElement('div');
    audioWrap.className='audio';
    const play = document.createElement('div'); 
    play.className='play'; 
    play.innerText='▶';
    audioWrap.appendChild(play);
    b.appendChild(audioWrap);

    // Áudio somente ao clicar
    play.addEventListener('click', ()=>{
      const utter = new SpeechSynthesisUtterance(extras.text);
      utter.lang='pt-BR';
      const voices = speechSynthesis.getVoices();
      const v = voices.find(x=>/pt-BR|brazilian/i.test(x.lang) && /female/i.test(x.name)) || voices.find(x=>/female/i.test(x.name)) || voices[0];
      if(v) utter.voice=v;
      speechSynthesis.speak(utter);
    });
  } else {
    b.innerHTML = text.replace(/\n/g,'<br>');
  }

  messagesEl.appendChild(b);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function handleUserMessage(){
  const text = inputEl.innerText.trim();
  if(!text) return;
  appendBubble(text,'me');
  inputEl.innerText='';

  // Resposta robotizada com áudio apenas (sem texto)
  const replyText = "Que ótimo, vou te passar 3 modelos sobre o curso, tá bom?";
  appendBubble('', 'bot', {isAudio:true, text:replyText});
}

sendBtn.addEventListener('click', handleUserMessage);
inputEl.addEventListener('keydown', e=>{
  if(e.key==='Enter' && !e.shiftKey){
    e.preventDefault();
    handleUserMessage();
  }
});

// Saudação inicial
window.addEventListener('load', ()=>{
  appendBubble('Oiie, meu amor, tudo bem? eu me chamo Melissa Castro','bot');
});
</script>
</body>
</html>
